- name: Unit test 1 - 2021 single filer, capped.
  period: 2021
  input:
    state_code: OR
    filing_status: SINGLE
    income_tax: 10_000
    non_refundable_ctc: 5_000
    income_tax_before_refundable_credits: 8_000
    refundable_ctc: 3_000
    cdcc: 8_000
    american_opportunity_credit: 1_000
    recovery_rebate_credit: 500
    premium_tax_credit: 500
    adjusted_gross_income: 120_000
  output:
    or_federal_tax_liability_subtraction: 7_050 # min(10,000, 7,050)
    # 10000+5000+8000-(3000+8000+1000+500+500)=10000

- name: Unit test 2 - 2021 single filer, not affected by the cap.
  period: 2021
  input:
    state_code: OR
    filing_status: SINGLE
    income_tax: 7_000
    non_refundable_ctc: 5_000
    income_tax_before_refundable_credits: 8_000
    refundable_ctc: 3_000
    cdcc: 8_000
    american_opportunity_credit: 1_000
    recovery_rebate_credit: 500
    premium_tax_credit: 500
    adjusted_gross_income: 80_000
  output:
    or_federal_tax_liability_subtraction: 7_000
    # 7000+5000+8000-(3000+8000+1000+500+500)=7000

- name: Unit test 3 - 2022 single filer, capped.
  period: 2022
  input:
    state_code: OR
    filing_status: SINGLE
    income_tax: 10_000
    non_refundable_ctc: 5_000 # not included 2022 and on
    income_tax_before_refundable_credits: 8_000
    refundable_ctc: 3_000 # not included 2022 and on
    cdcc: 8_000 # not included 2022 and on
    american_opportunity_credit: 1_000
    recovery_rebate_credit: 500
    premium_tax_credit: 500
    adjusted_gross_income: 120_000
  output:
    or_federal_tax_liability_subtraction: 7_250 # min(16,000, 7,250)
    # 10000+0+8000-(0+0+1000+500+500)=16000

- name: Unit test 3 - 2022 single filer, not affected by the cap..
  period: 2022
  input:
    state_code: OR
    filing_status: SINGLE
    income_tax: 2_000
    non_refundable_ctc: 5_000 # not included 2022 and on
    income_tax_before_refundable_credits: 3_000
    refundable_ctc: 3_000 # not included 2022 and on
    cdcc: 8_000 # not included 2022 and on
    american_opportunity_credit: 1_000
    recovery_rebate_credit: 500
    premium_tax_credit: 500
    adjusted_gross_income: 80_000
  output:
    or_federal_tax_liability_subtraction: 3_000 # min(3,000, 7,250)
    # 2000+0+3000-(0+0+1000+500+500)=3000
